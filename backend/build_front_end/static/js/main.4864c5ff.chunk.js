(this.webpackJsonpgefco=this.webpackJsonpgefco||[]).push([[0],{177:function(e,t){},231:function(e,t,n){},233:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(0),o=n(23),c=n.n(o),i=n(7),s=n(99),l=n(6),d=n(30),u=n(12),j=n(124),b=n(15),m=n(63),f=n.n(m),O="http://localhost:8180",h=["branches","cities","departments","divisions"],p=["branch","city","department","division"],x=["TPK","OS","PP","PL"],g=n(239),v=function(e,t){var n=t.employee;if(n)return Object(a.jsxs)(a.Fragment,{children:[n.first_name," ",n.last_name]})},y=function(e){if(!e)return"-";var t=e.Time;return e.Valid?t.substr(0,10).split("-").reverse().join("."):"-"},S=function(e,t){return Object(a.jsx)(a.Fragment,{children:y(t.date)})},w=function(e,t){return Object(a.jsx)(a.Fragment,{children:y(t.deadline)})},F=function(e,t){return Object(a.jsx)(a.Fragment,{children:y(t.release_date)})},k=function(e,t){return Object(a.jsx)(a.Fragment,{children:y(t.s_date)})},E=function(e,t){return Object(a.jsx)(a.Fragment,{children:y(t.signatures[0].date)})},C=function(e,t){return Object(a.jsx)(a.Fragment,{children:y(t.e_date)})},T=function(e,t){return Math.round(100*t.complete)/100+"%"},_=function(e,t){var n=t.link;return n&&"www"===n.substr(0,3)&&(n="https://"+n),Object(a.jsx)("a",{href:n,target:"_blank",rel:"noreferrer",children:t.name})},D=function(e,t){var n=function(){return Object(a.jsxs)("h5",{children:[Object(a.jsx)(g.a,{style:{color:"red",marginBottom:"6px"}})," ",_(0,t)]})},r=t.deadline<Date.now()&&t.employees.find((function(e){return e.state.includes("e")||e.state.includes("s")}));return Object(a.jsx)(a.Fragment,{children:r?Object(a.jsx)(n,{}):_(0,t)})},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{dataField:""+e,text:t,sort:!0,headerStyle:{width:"1%"}}},R=function(e){return Object.keys(e).includes("link")?"document":"training"},P=function(e){return!0===e.require_superior},M=function(e){return console.log(e.signatures[0].superior_id),console.log(A().id),e.signatures[0].superior_id===A().id},L=function(e){return e.map((function(e){if(!P(e)||!M(e))return e.id}))},z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";return[{dataField:e,order:t}]},A=function(){return JSON.parse(sessionStorage.getItem("user"))},I=function(){return sessionStorage.removeItem("user")},B=function(){return null!==A()&&"admin"===A().role},q=function(e){return{variant:"success",body:e}},H=function(e){return{variant:"danger",body:e}},U=function(e){return 200<=e.status&&e.status<=299},G=function(e){return e?e.id:0},J=function(e){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("option",{hidden:!0,value:"",children:"Select option ..."}),e.map((function(e){return Object(a.jsx)("option",{value:e,children:e},f()())}))]})},V=function(e){return e.map((function(e){var t={};return p.forEach((function(n){t[n]={value:e["".concat(n,"_id")],label:e["".concat(n,"_name")]}})),t}))},X=function(e){var t,n,a,r;return{branches:null===(t=e.branches)||void 0===t?void 0:t.map((function(e){return{value:e.id,label:e.name}})),divisions:null===(n=e.divisions)||void 0===n?void 0:n.map((function(e){return{value:e.id,label:e.name}})),departments:null===(a=e.departments)||void 0===a?void 0:a.map((function(e){return{value:e.id,label:e.name}})),cities:null===(r=e.cities)||void 0===r?void 0:r.map((function(e){return{value:e.id,label:e.name}}))}};function W(e,t){if(e.cancel)return"-";var n=e.e_date.Valid?"":"e";return t&&!e.s_date.Valid&&(n+="s"),n}var Z=function(e){return e.filter((function(e){return null!==e.employee})).sort((function(e,t){return e.employee.last_name<t.employee.last_name?-1:e.employee.last_name>t.employee.last_name?1:0}))},K=function(e,t,n){return e?e.assigned_to.split("&").map((function(e){var a=e.split("#"),r=Object(i.a)(a,3),o=r[0],c=r[1],s=(r[2],o.split("; ")),l={id:f()()};return h.forEach((function(e,n){(l[e]=[],"x"!==s[n])&&s[n].split(",").forEach((function(n){l[e].push({value:n,label:Y(e,n,t)})}))})),l.removedEmployees=[],c?(c.split(",").forEach((function(e){l.removedEmployees.push({value:e,label:Q(e,n,t.departments)})})),l):l})):[]},Y=function(e,t,n){var a,r;return(null===(a=n[e])||void 0===a||null===(r=a.find((function(e){return e.id==t})))||void 0===r?void 0:r.name)||"unknown"},Q=function(e,t,n){if(!t)return"unknown";var a=t.find((function(t){return t.id.toString()===e}));return a?ae(a,n):"unknown"},$=function(e){return{Time:e+"T00:00:00Z",Valid:!0}},ee=function(e){return e.Time.substr(0,10)},te=function(e){var t=e.map((function(e){var t=h.map((function(t){var n=e[t];return console.log("values",n),n.length?n.map((function(e){return e.value})).join(","):"x"})).join("; "),n=e.removedEmployees.map((function(e){return e.value})).join(",");return"".concat(t,"#").concat(n,"#")}));return console.log(t),t.join("&")},ne=function(e){return e.sort((function(e,t){return e.last_name<t.last_name?-1:e.last_name>t.last_name?1:0}))},ae=function(e,t){var n,a=e.id,r=e.first_name,o=e.last_name,c=e.department_id,i=null===(n=t.find((function(e){return e.id===c})))||void 0===n?void 0:n.name;return"".concat(r," ").concat(o," [").concat(a,", ").concat(i,"]")},re=function(e,t){if(!e.length)return[];function n(e,t){var n=e.map((function(e){return e[t].map((function(e){return e.label}))}));return Object(b.a)(new Set(n.flat())).join(", ")}return e.map((function(e){var a=K(e,t);return Object(l.a)(Object(l.a)({},e),{},{branches:n(a,"branches"),cities:n(a,"cities"),divisions:n(a,"divisions"),departments:n(a,"departments")})}))},oe=function(e){return fetch(O+e,{method:"GET"}).then((function(e){return e.json()}))},ce=function(e,t){return console.log("body",t),fetch(O+e,{method:"POST",body:t}).then((function(e){return e.json()}))},ie=n(121),se=n.n(ie),le=function(e){var t=e.title,n=e.data,r=e.columns,o=e.order,c=e.expandRow,i=e.classes,s=Object(d.a)(e,["title","data","columns","order","expandRow","classes"]),u=function(){return t?Object(a.jsx)("h5",{style:{borderRadius:"0.25em",textAlign:"center",border:"2px solid gray",margin:"2% 0",padding:"0.5em",marginTop:"1.5%"},children:t}):null};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(u,{}),Object(a.jsx)(se.a,Object(l.a)({keyField:"id",hover:!0,classes:i,data:n,columns:r,noDataIndication:function(){return Object(a.jsx)("i",{children:"Table is empty"})},defaultSorted:o,expandRow:c},s))]})},de=n(38),ue=function(e,t,n,r){var o=r.setModalInfo,c=r.setShowModal,i=r.asSuperior;return Object(a.jsx)(de.a,{onClick:function(){P(t)&&M(t)||(c(!0),o(Object(l.a)(Object(l.a)({},t),{},{asSuperior:i})))},size:"sm",className:"btn-block",children:P(t)&&M(t)?"Details":"Sign"})},je=function(e,t){return P(t)&&M(t)?Object(a.jsx)(de.a,{size:"sm",children:"Details"}):C(0,t.signatures[0])},be=n(122),me=function(){return Object(a.jsx)(be.a,{animation:"border",className:"m-5"})},fe=function(e){var t=e.e;return Object(a.jsx)("h6",{className:"p-5",children:t})},Oe=function(e){var t=Object(r.useState)(),n=Object(i.a)(t,2),a=n[0],o=n[1],c=Object(r.useState)(),s=Object(i.a)(c,2),l=s[0],d=s[1],u=Object(r.useState)(!1),j=Object(i.a)(u,2),b=j[0],m=j[1];return Object(r.useEffect)((function(){console.log("url",e),fetch(O+e,{method:"GET"}).then((function(e){return e.json()})).then((function(e){m(!0),o(e)}),(function(e){m(!0),d(e)}))}),[]),[a,b,l]},he=n(75),pe=function(e){var t=e.showModal,n=e.setShowModal,r=e.modalInfo,o=e.handleAccept;console.log(r);var c=function(){return n(!1)},i="";if(r.body)i=r.body;else if(r.asSuperior){i="Do you really want do sign for ".concat("".concat(r.employee.first_name," ").concat(r.employee.last_name))}else i="Do you really want do sign the document named ".concat(r.name);return Object(a.jsxs)(he.a,{show:t,onHide:c,centered:!0,children:[Object(a.jsx)(he.a.Header,{closeButton:!0,children:Object(a.jsx)(he.a.Title,{children:"Confirm"})}),Object(a.jsx)(he.a.Body,{children:Object(a.jsx)("p",{children:i})}),Object(a.jsxs)(he.a.Footer,{children:[Object(a.jsx)(de.a,{variant:"danger",onClick:function(){o(),c()},children:"Accept"}),Object(a.jsx)(de.a,{variant:"secondary",onClick:c,children:"Close"})]})]})},xe=function(){var e="/unsigned/signatures/".concat(A().id),t=Oe(e),n=Object(i.a)(t,3),o=n[0],c=n[1],s=n[2],d=Object(r.useState)(!1),u=Object(i.a)(d,2),j=u[0],b=u[1],m=Object(r.useState)([]),f=Object(i.a)(m,2),h=f[0],p=f[1],x=Object(r.useState)([]),g=Object(i.a)(x,2),y=g[0],k=g[1],E=Object(r.useState)([]),T=Object(i.a)(E,2),D=T[0],P=T[1];if(Object(r.useEffect)((function(){o&&(o.documents.forEach((function(e){M(e)&&(e.signatures=e.signatures.filter((function(e){return e.employee&&e.employee_id!==e.superior_id})))})),P(o.documents),k(o.trainings))}),[o]),s)return Object(a.jsx)(fe,{e:"Error: ".concat(s.message)});if(!c||!o)return Object(a.jsx)(me,{});var I=function(e,t){return fetch(O+e,{method:"POST",body:new URLSearchParams("id=".concat(t))})},B=function(e){var t=R(h);I("/sign/".concat(t),e).then((function(n){U(n)&&("training"===t?H(e):G(e))}))},q=function(e){I("/sign/superior",e).then((function(t){U(t)&&J(e)}))},H=function(e){k(y.filter((function(t){return t.signatures[0].id!==e})))},G=function(e){P(D.filter((function(t){return t.signatures[0].id!==e})))},J=function(e){var t=D.map((function(t){return Object(l.a)(Object(l.a)({},t),{},{signatures:t.signatures.filter((function(t){return t.id!==e}))})}));P(t.filter((function(e){return e.signatures.length})))},V=function(e,t){return[{dataField:"name",text:"Name",sort:!0},{dataField:"date.Time",text:"Date",sort:!0,formatter:S},{dataField:"deadline.Time",text:"Deadline",sort:!0,formatter:w},Object(l.a)(Object(l.a)({},N()),{},{formatter:ue,formatExtraData:{setModalInfo:e,setShowModal:t}})]}(p,b),X=function(e,t){return[{dataField:"name",text:"Name",sort:!0,formatter:_},{dataField:"release_date.Time",text:"Release",sort:!0,formatter:F},{dataField:"deadline.Time",text:"Deadline",sort:!0,formatter:w},Object(l.a)(Object(l.a)({},N()),{},{formatter:ue,formatExtraData:{setModalInfo:e,setShowModal:t,asSuperior:!1}})]}(p,b),W=function(e,t){return[{dataField:"employee.id",text:"Employee ID",sort:!0},{dataField:"employee.last_name",text:"Full name",sort:!0,formatter:v},{dataField:"e_date.Time",text:"Sign Date",sort:!0,formatter:C},Object(l.a)(Object(l.a)({},N()),{},{formatter:ue,formatExtraData:{setModalInfo:e,setShowModal:t,asSuperior:!0}})]}(p,b),Z={onlyOneExpanding:!0,nonExpandable:L(D),renderer:function(e){return Object(a.jsx)(le,{classes:"inner-table",data:e.signatures,columns:W,order:z("employee.last_name")})}};return console.log(o),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(le,{title:"Documents to sign",data:D,columns:X,order:z("deadline.Time"),expandRow:Z}),Object(a.jsx)(le,{title:"Trainings to sign",data:y,columns:V,order:z("deadline.Time")}),Object(a.jsx)(pe,{showModal:j,setShowModal:b,modalInfo:h,handleAccept:function(){h.asSuperior?q(h.id):B(h.signatures[0].id),b(!1)}})]})},ge=n(60),ve=n(247),ye=n(240),Se=n(123),we=function(e){var t=e.notification;return t?Object(a.jsx)(Se.a,{variant:t.variant,children:t.body}):null},Fe={sk:{loginPage:{header:"Prihlasovanie",login:"Login",password:"Heslo",submit:"Prihl\xe1si\u0165 sa",notification:{wrongLogin:"Zl\xe9 prihlasovacie \xfadaje",wrongCard:"Nepodarilo sa prihl\xe1senie kartou"}},navigation:{login:"Prihlasit sa",recordsToSign:"Na podp\xedsanie",signedRecords:"Podp\xedsan\xe9",addRecord:"Prida\u0165",savedRecords:"Ulo\u017een\xe9",finder:"Vyh\u013ead\xe1vanie",settings:"Nastavenia",logout:"Odhl\xe1si\u0165 sa"}},en:{loginPage:{header:"Login",login:"Login",password:"Password",submit:"Login",notification:{wrongLogin:"Wrong login input",wrongCard:"Wrong card input"}},navigation:{login:"Login",recordsToSign:"To sign",signedRecords:"Signed",addRecord:"Add new",savedRecords:"Saved",finder:"Finder",settings:"Settings",logout:"Logout"}}},ke=function(e){var t=e.onSubmit,n=e.language,r=e.setLanguage,o=e.notification,c=Object(ge.a)(),i=c.register,s=c.handleSubmit,l=function(e){return n===e},d=Fe[n].loginPage,u=d.header,b=d.login,m=d.password,f=d.submit;return Object(a.jsx)(j.a,{className:"login-container",children:Object(a.jsxs)(ve.a,{onSubmit:s(t),children:[Object(a.jsx)("h3",{align:"center",children:u}),Object(a.jsxs)(ye.a,{onClick:function(e){return r(e.target.id)},className:"container-fluid p-0 mt-4 mb-5 btn-group",children:[Object(a.jsx)(de.a,{id:"sk",active:l("sk"),children:"Slovak"}),Object(a.jsx)(de.a,{id:"cz",active:l("cz"),disabled:!0,children:"Czech"}),Object(a.jsx)(de.a,{id:"en",active:l("en"),children:"English"}),Object(a.jsx)(de.a,{id:"hu",active:l("hu"),disabled:!0,children:"Hungary"})]}),Object(a.jsxs)(ve.a.Group,{children:[Object(a.jsx)(ve.a.Label,{children:b}),Object(a.jsx)(ve.a.Control,{name:"login",ref:i,required:!0})]}),Object(a.jsxs)(ve.a.Group,{children:[Object(a.jsx)(ve.a.Label,{children:m}),Object(a.jsx)(ve.a.Control,{name:"password",type:"password",ref:i,required:!0})]}),o&&Object(a.jsx)(we,{notification:o}),Object(a.jsx)(de.a,{type:"submit",variant:"dark",className:"btn-block",children:f})]})})},Ee=n(176),Ce=function(e){var t=(e=e.toString().toLowerCase()).charCodeAt(0)%12+7,n=Ee.HmacSHA256(e.repeat(t),"Doli-Doli").toString(Ee.enc.Base64);return n=encodeURIComponent(n.toString()),console.log(n),n},Te=function(){var e=Object(r.useState)(),t=Object(i.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)("sk"),s=Object(i.a)(c,2),l=s[0],d=s[1],j=Fe[l].loginPage.notification,b=j.wrongLogin,m=j.wrongCard,f="",h=p();function p(){return setTimeout(x,40)}function x(){10===f.length&&y(f),f=""}clearTimeout(h);var g=function(e){var t=String.fromCharCode(e.keyCode).toLowerCase();(function(e){return function(e){return e.keyCode>=65&&e.keyCode<=90}(e)||function(e){return e.keyCode>=48&&e.keyCode<=57}(e)})(e)&&(f+=t,clearTimeout(h),h=p())};Object(r.useEffect)((function(){return document.addEventListener("keydown",g),function(){return document.removeEventListener("keydown",g)}}));var v=function(e){var t={id:e.id,role:e.role,first_name:e.first_name,last_name:e.last_name};sessionStorage.setItem("user",JSON.stringify(t)),window.location.reload(!1)},y=function(e){fetch(O+"/auth/kiosk",{method:"POST",body:new URLSearchParams("card=".concat(e))}).then((function(e){return e.json()})).then((function(e){v(e)})).catch((function(){return o(H(m))}))};return A()?Object(a.jsx)(u.a,{to:"/records-to-sign"}):Object(a.jsx)(ke,{onSubmit:function(e){fetch(O+"/auth/login",{method:"POST",body:new URLSearchParams("login=".concat(e.login,"&password=").concat(Ce(e.password)))}).then((function(e){return e.json()})).then((function(e){v(e)})).catch((function(){return o(H(b))}))},language:l,setLanguage:d,notification:n})},_e=function(){return I(),Object(a.jsx)(u.a,{to:"/login"})},De=function(){var e="/signed/signatures/".concat(A().id),t=Oe(e),n=Object(i.a)(t,3),r=n[0],o=n[1],c=n[2];if(c)return Object(a.jsx)(fe,{e:"Error: ".concat(c.message)});if(!o||!r)return Object(a.jsx)(me,{});console.log("signed",r);var s=[{dataField:"name",text:"Name",sort:!0,formatter:_},{dataField:"release_date.Time",text:"Release",sort:!0,formatter:F},{dataField:"signatures[0].e_date.Time",text:"Signed date",sort:!0,formatter:je}],l=[{dataField:"employee.id",text:"Employee ID",sort:!0},{dataField:"employee.last_name",text:"Full name",sort:!0,formatter:v},{dataField:"e_date.Time",text:"Employee Sign",sort:!0,formatter:C},{dataField:"s_date.Time",text:"My Sign",sort:!0,formatter:k}],d=[{dataField:"name",text:"Name",sort:!0},{dataField:"date.Time",text:"Took place",sort:!0,formatter:S},{dataField:"signatures[0].date.Time",text:"Signed date",sort:!0,formatter:E}],u={onlyOneExpanding:!0,nonExpandable:L(r.documents),renderer:function(e){return Object(a.jsx)(le,{classes:"inner-table",data:e.signatures,columns:l,order:z("employee.last_name")})}};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(le,{title:"Signed Documents",data:r.documents,columns:s,expandRow:u,order:z("release_date.Time","desc")}),Object(a.jsx)(le,{title:"Signed Trainings",data:r.trainings,columns:d,order:z("date.Time","desc")})]})},Ne=n(241),Re=n(84),Pe=function(e){var t=e.label,n=e.name,r=e.placeholder,o=e.type,c=e.register,i=e.as,s=e.required;return Object(a.jsxs)(ve.a.Group,{as:Ne.a,children:[Object(a.jsx)(ve.a.Label,{column:!0,sm:"3",children:t}),Object(a.jsx)(Re.a,{children:Object(a.jsx)(ve.a.Control,{name:n,placeholder:r,ref:c,type:o,as:i,required:s})})]})},Me=n(243),Le=n(244),ze=n(245),Ae=n(19),Ie=n(74),Be=function(e){var t=e.prefill,n=e.disabled,o=e.employees,c=e.combinations,i=e.combination,s=e.setCombination,d=e.notification;console.log(c);var u=Object(r.useContext)(wt),j=X(u),b=function(e,t){var n=t.name;s(Object(l.a)(Object(l.a)({},i),{},Object(Ae.a)({},n,e)))},m=function(e,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j[e];return Object(a.jsxs)(a.Fragment,{children:[r,Object(a.jsx)(Ie.a,{isMulti:!0,placeholder:"",name:e,options:o,defaultValue:t?t[e]:[],isDisabled:t&&"removedEmployees"!==e||n.includes(e),onChange:function(e,t){return b(e,t)}}),Object(a.jsx)("br",{})]})};return Object(a.jsxs)(Re.a,{className:"p-0",children:[m("branches","Branches"),m("divisions","Divisions"),m("departments","Departments"),m("cities","Cities"),o&&m("removedEmployees","Remove employees",o),d&&Object(a.jsx)(we,{notification:d})]})},qe=function(e){var t=e.prefill,n=e.combinations,o=e.setAssignedTo,c=e.setEmptyAssign,s=e.closeModal,d=Object(r.useContext)(wt),u=Object(r.useState)([]),m=Object(i.a)(u,2),O=m[0],p=m[1],x=Object(r.useState)(),g=Object(i.a)(x,2),v=g[0],y=g[1],S=Object(r.useState)(),w=Object(i.a)(S,2),F=w[0],k=w[1],E=Object(r.useState)(t||{branches:[],divisions:[],departments:[],cities:[],removedEmployees:[]}),C=Object(i.a)(E,2),T=C[0],_=C[1];function D(){p(h);var e=te([T]);oe("/employees/".concat(e)).then((function(e){e.length?N(e):y(H("not valid combination"))})).catch((function(e){y(H("not valid combination")),console.log("Errrrrrrrrrrror",e)}))}Object(r.useEffect)((function(){t&&D()}),[]);var N=function(e){k(e.map((function(e){return{value:e.id,label:ae(e,d.departments)}})))};return Object(a.jsx)(he.a,{show:!0,onHide:s,centered:!0,children:Object(a.jsxs)(j.a,{className:"pt-3 pb-3 pl-5 pr-5",children:[Object(a.jsx)(he.a.Header,{closeButton:!0,children:Object(a.jsx)(he.a.Title,{children:"Add new combination"})}),Object(a.jsx)(he.a.Body,{children:Object(a.jsx)(Be,{prefill:t,disabled:O,employees:F,combinations:n,combination:T,setCombination:_,notification:v,setNotification:y})}),Object(a.jsx)(he.a.Footer,{children:Object(a.jsxs)(Re.a,{className:"text-center",children:[t?Object(a.jsx)(de.a,{onClick:function(){o((function(e){return e.map((function(e){return e.id===(null===t||void 0===t?void 0:t.id)?Object(l.a)(Object(l.a)({},T),{},{id:f()()}):e}))})),s()},size:"sm",className:"mr-2",children:"Save"}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(de.a,{onClick:D,size:"sm",className:"mr-2",children:"Preview"}),Object(a.jsx)(de.a,{onClick:function(){var e=te([T]);oe("/employees/".concat(e)).then((function(e){e.length?(y(void 0),c([!1]),o((function(e){return[].concat(Object(b.a)(e),[Object(l.a)(Object(l.a)({},T),{},{id:f()()})])})),s()):y(H("not valid combination"))})).catch((function(e){y(H("not valid combination")),console.log("Errrrrrrrrrrror",e)}))},size:"sm",className:"mr-2",children:"Add"})]}),Object(a.jsx)(de.a,{onClick:s,variant:"secondary",size:"sm",children:"close"})]})})]})})},He=n(246),Ue=n(242),Ge=function(e){var t=e.combinations,n=e.assignedTo,o=e.setAssignedTo,c=e.setEmptyAssign,s=Object(r.useState)(!1),d=Object(i.a)(s,2),u=d[0],j=d[1],b=Object(r.useState)(),m=Object(i.a)(b,2),f=m[0],O=m[1],h=function(){return j(!0)},p=function(){return Object(a.jsxs)(de.a,{variant:"dark",onClick:h,size:"sm",className:"mb-2",children:[Object(a.jsx)(ze.a,{size:"20",color:"white"}),Object(a.jsx)("span",{children:"add combination"})]})},x=function(e){return Object(a.jsx)(a.Fragment,{children:null===e||void 0===e?void 0:e.map((function(e){return e.label})).join(",")})},g=[{dataField:"branches",text:"Branches",formatter:function(e,t){return x(t.branches)}},{dataField:"divisions",text:"Divisions",formatter:function(e,t){return x(t.divisions)}},{dataField:"departments",text:"Departments",formatter:function(e,t){return x(t.departments)}},{dataField:"cities",text:"Cities",formatter:function(e,t){return x(t.cities)}},Object(l.a)(Object(l.a)({},N("edit")),{},{formatter:function(e,t){return Object(a.jsx)(He.a,{placement:"right",overlay:Object(a.jsx)(Ue.a,{id:"tooltip-right",className:"text-left",children:t.removedEmployees&&t.removedEmployees.length?t.removedEmployees.map((function(e){return Object(a.jsx)("p",{children:e.label},e.value)})):Object(a.jsx)("p",{children:"Empty"})}),children:Object(a.jsx)(Me.a,{size:"25",color:"black",onClick:function(){return function(e){O(e),h()}(t)}})})}}),Object(l.a)(Object(l.a)({},N("del")),{},{formatter:function(e,t){return Object(a.jsx)(Le.a,{size:"25",color:"red",onClick:function(){return function(e){o((function(t){return t.filter((function(t){return t.id!==e.id}))}))}(t)}})}})];return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(le,{data:n,columns:g,wrapperClasses:"table-responsive",rowClasses:"text-nowrap"}),Object(a.jsx)(p,{}),u&&Object(a.jsx)(qe,{prefill:f,combinations:t,setAssignedTo:o,setEmptyAssign:c,closeModal:function(){O(void 0),j(!1)}})]})},Je=function(e){var t,n=e.setRecords,o=e.formData,c=e.setFormData,s=e.actual,d=Object(r.useContext)(wt),u=Object(r.useState)(!1),j=Object(i.a)(u,2),b=j[0],m=j[1],f=Object(r.useState)({}),h=Object(i.a)(f,2),p=h[0],g=h[1],v=Object(ge.a)({defaultValues:(t=o,t?Object(l.a)(Object(l.a)({},t),{},{release_date:ee(t.release_date),deadline:ee(t.deadline)}):{})}),y=v.register,S=v.handleSubmit,w=x,F=Object(r.useState)(),k=Object(i.a)(F,2),E=k[0],C=k[1],T=Object(r.useState)(o?o.type:""),_=Object(i.a)(T,2),D=_[0],N=_[1],R=Object(r.useState)(!1),P=Object(i.a)(R,2),M=P[0],L=P[1],z=Object(r.useState)(G(o)),A=Object(i.a)(z,2),I=A[0],B=A[1],X=Object(r.useState)(),W=Object(i.a)(X,2),Z=W[0],Y=W[1],Q=Object(r.useState)([]),ne=Object(i.a)(Q,2),ae=ne[0],re=ne[1],oe=Object(r.useState)([]),ce=Object(i.a)(oe,2),ie=ce[0],se=ce[1],le=Object(r.useState)([!0]),ue=Object(i.a)(le,2),je=ue[0],be=ue[1];Object(r.useEffect)((function(){return Y(void 0)}),je),Object(r.useEffect)((function(){fetch(O+"/combinations",{method:"GET"}).then((function(e){return e.json()})).then((function(e){re(V(e))})).catch((function(e){return console.log(e)})),fetch(O+"/employees/all",{method:"GET"}).then((function(e){return e.json()})).then((function(e){se(K(o,d,e))})).catch((function(e){return console.log(e)}))}),[]);var me=function(e){console.log("raw",ie),e=function(e,t){return console.log("correctDocumentFormData",e),Object(l.a)(Object(l.a)({},e),{},{release_date:$(e.release_date),deadline:$(e.deadline),assigned_to:te(t)})}(e||p,ie),console.log("data",e),"save"===E&&(I?(e=Object(l.a)(Object(l.a)({},e),{},{id:I}),fe(e,"update"),xe(e)):fe(e,"create").then((function(e){return B(null===e||void 0===e?void 0:e.id)}))),"send"===E&&(I?(e=Object(l.a)(Object(l.a)({},e),{},{id:I}),s?Oe(e,"create/confirm").then((function(e){return B(null===e||void 0===e?void 0:e.id)})):Oe(e,"update/confirm")):Oe(e,"create/confirm").then((function(e){return B(null===e||void 0===e?void 0:e.id)})),L(!0))},fe=function(e,t){return console.log(e),fetch(O+"/document/".concat(t),{method:"POST",body:JSON.stringify(e)}).then((function(e){return U(e)?Y(q("".concat(t," was successful"))):Y(H("".concat(t," failed"))),e.json()})).catch((function(e){return console.log("error",e)}))},Oe=function(e,t){return console.log(e),fetch(O+"/document/".concat(t),{method:"POST",body:JSON.stringify(e)}).then((function(a){return Y(q("".concat(t," was successful"))),n&&he(e),c&&c(void 0),console.log(a),a.json()})).catch((function(e){Y(H("".concat(t," failed"))),console.log("error",e)}))},he=function(e){n((function(t){return t.filter((function(t){return t.id!==e.id}))}))},xe=function(e){n&&n((function(t){var n=t;return n[t.findIndex((function(t){return t.id===e.id}))]=e,n}))};return Object(a.jsxs)(ve.a,{onChange:function(){return Y(void 0)},onSubmit:S((function(e){0!==ie.length?(g(e),"send"===E?m(!0):me(e)):Y(H("At least one combination is required"))})),children:[Object(a.jsxs)(ve.a.Group,{as:Ne.a,children:[Object(a.jsx)(ve.a.Label,{column:!0,sm:"3",children:"Type*"}),Object(a.jsx)(Re.a,{children:Object(a.jsx)(ve.a.Control,{onChange:function(e){return N(e.target.value)},as:"select",name:"type",ref:y({validate:function(e){return""!==e}}),required:!0,value:D,children:J(w)})})]}),Object(a.jsxs)(ve.a.Group,{as:Ne.a,children:[Object(a.jsx)(ve.a.Label,{column:!0,sm:"3",children:" "}),Object(a.jsx)(Re.a,{children:Object(a.jsx)(ve.a.Check,{inline:!0,label:"require superior",name:"require_superior",ref:y})})]}),Object(a.jsx)(Pe,{label:"Document name*",name:"name",placeholder:"Enter document name",register:y,required:!0}),Object(a.jsx)(Pe,{label:"Document number*",name:"order_number",type:"number",placeholder:"Enter number",register:y({valueAsNumber:!0}),required:!0}),Object(a.jsx)(Pe,{label:"Version*",name:"version",placeholder:"Enter version",register:y,required:!0}),Object(a.jsx)(Pe,{label:"Link to sharepoint",name:"link",placeholder:"Enter document link to sharepoint",register:y}),Object(a.jsx)(Pe,{label:"Release date*",name:"release_date",type:"date",register:y,required:!0}),Object(a.jsx)(Pe,{label:"Days to deadline*",name:"deadline",type:"date",register:y,required:!0}),Object(a.jsx)(Pe,{label:"Note",name:"note",as:"textarea",placeholder:"Enter note",register:y}),Object(a.jsx)(Ge,{combinations:ae,assignedTo:ie,setAssignedTo:se,emptyAssign:je,setEmptyAssign:be}),Z&&Object(a.jsx)(we,{notification:Z}),Object(a.jsxs)("div",{className:"pt-1 btn-block text-right",children:[Object(a.jsx)(de.a,{variant:"outline-primary",type:"submit",className:"mr-1",disabled:M,onClick:function(){return C("save")},children:"Save"}),Object(a.jsx)(de.a,{type:"submit",onClick:function(){return C("send")},disabled:M,children:s?"Send as new version":"Send"})]}),b&&Object(a.jsx)(pe,{handleAccept:me,showModal:b,setShowModal:m,modalInfo:{body:"Do you really want to send the record to the employees?"}})]})},Ve=n(127),Xe=(n(230),function(e){var t,n=e.setRecords,o=e.formData,c=e.setFormData,s=e.actual,d=Object(r.useContext)(wt),u=Object(r.useState)(!1),j=Object(i.a)(u,2),b=j[0],m=j[1],f=Object(r.useState)({}),h=Object(i.a)(f,2),p=h[0],x=h[1],g=Object(ge.a)({defaultValues:(t=o,t?Object(l.a)(Object(l.a)({},t),{},{date:ee(t.date),deadline:ee(t.deadline)}):{})}),v=g.register,y=g.handleSubmit,S=Object(r.useState)(),w=Object(i.a)(S,2),F=w[0],k=w[1],E=Object(r.useState)(!1),C=Object(i.a)(E,2),T=C[0],_=C[1],D=Object(r.useState)(G(o)),N=Object(i.a)(D,2),R=N[0],P=N[1],M=Object(r.useState)(),L=Object(i.a)(M,2),z=L[0],A=L[1],I=Object(r.useState)([]),B=Object(i.a)(I,2),J=B[0],V=B[1],X=Object(r.useState)([]),W=Object(i.a)(X,2),Z=W[0],K=W[1],Y=Object(r.useState)([!0]),Q=Object(i.a)(Y,2),te=Q[0],re=Q[1];Object(r.useEffect)((function(){return A(void 0)}),te),Object(r.useEffect)((function(){fetch(O+"/employees/all",{method:"GET"}).then((function(e){return e.json()})).then((function(e){V(e),K(function(e,t){return t=ne(t),e&&e.employees?e.employees.split(",").map((function(e){return t.find((function(t){return t.id==e}))})):[]}(o,e))})).catch((function(e){return console.log(e)}))}),[]);var oe=function(e){e=function(e,t){return Object(l.a)(Object(l.a)({},e),{},{date:$(e.date),deadline:$(e.deadline),employees:t.map((function(e){return e.id})).join(",")})}(e||p,Z),"save"===F&&(R?(e=Object(l.a)(Object(l.a)({},e),{},{id:R}),ce(e,"update"),le(e)):ce(e,"create").then((function(e){return P(null===e||void 0===e?void 0:e.id)}))),"send"===F&&(R?(e=Object(l.a)(Object(l.a)({},e),{},{id:R}),s?ie(e,"create/confirm").then((function(e){return P(null===e||void 0===e?void 0:e.id)})):ie(e,"update/confirm")):ie(e,"create/confirm").then((function(e){return P(null===e||void 0===e?void 0:e.id)})),_(!0))},ce=function(e,t){return fetch(O+"/training/".concat(t),{method:"POST",body:JSON.stringify(e)}).then((function(e){return U(e)?A(q("".concat(t," was successful"))):A(H("".concat(t," failed"))),e.json()})).catch((function(e){return console.log("error",e)}))},ie=function(e,t){return console.log(e),fetch(O+"/training/".concat(t),{method:"POST",body:JSON.stringify(e)}).then((function(a){return U(a)?(A(q("".concat(t," was successful"))),n&&se(e),c&&c(void 0)):A(H("".concat(t," failed"))),console.log(a),a.json()})).catch((function(e){return console.log("error",e)}))},se=function(e){n((function(t){return t.filter((function(t){return t.id!==e.id}))}))},le=function(e){n&&n((function(t){var n=t;return n[t.findIndex((function(t){return t.id===e.id}))]=e,n}))};return Object(a.jsxs)(ve.a,{onChange:function(){return A(void 0)},onSubmit:y((function(e){console.log("data onSubmit",e),Z.length?(x(e),"send"===F?m(!0):oe(e)):A(H("At least one employee is required"))})),children:[Object(a.jsx)(Pe,{label:"Training name*",name:"name",placeholder:"Enter document name",register:v,required:!0}),Object(a.jsx)(Pe,{label:"Name of lector",name:"lector",placeholder:"Enter document link to sharepoint",register:v}),Object(a.jsx)(Pe,{label:"Name of agency",name:"agency",placeholder:"Enter agency",register:v}),Object(a.jsx)(Pe,{label:"Place",name:"place",placeholder:"Enter place",register:v}),Object(a.jsx)(Pe,{label:"Date*",name:"date",type:"date",placeholder:"Enter date",register:v,required:!0}),Object(a.jsx)(Pe,{label:"Days to deadline*",name:"deadline",type:"date",defaultValue:"14",register:v,required:!0}),Object(a.jsx)(Pe,{label:"Duration",name:"duration",type:"number",placeholder:"Enter duration",register:v({valueAsNumber:!0})}),Object(a.jsx)(Pe,{label:"Agenda*",name:"agenda",as:"textarea",placeholder:"Enter agenda",register:v,required:!0}),Object(a.jsxs)(ve.a.Group,{as:Ne.a,children:[Object(a.jsx)(ve.a.Label,{column:!0,sm:"3",children:"Add employees*"}),Object(a.jsx)(Re.a,{children:Object(a.jsx)(Ve.a,{id:"basic-typeahead-single",name:"employees",labelKey:function(e){return ae(e,d.departments)},multiple:!0,placeholder:"Choose an employees...",selected:Z,options:J,onChange:function(e){K(e),re([!1])}})})]}),z&&Object(a.jsx)(we,{notification:z}),Object(a.jsxs)("div",{className:"pt-1 btn-block text-right",children:[Object(a.jsx)(de.a,{variant:"outline-primary",type:"submit",className:"mr-1",disabled:T,onClick:function(){return k("save")},children:"Save"}),Object(a.jsx)(de.a,{type:"submit",onClick:function(){return k("send")},disabled:T,children:"Send"})]}),b&&Object(a.jsx)(pe,{handleAccept:oe,showModal:b,setShowModal:m,modalInfo:{body:"Do you really want to send the record to the employees?"}})]})}),We=function(){var e=Object(r.useState)("document"),t=Object(i.a)(e,2),n=t[0],o=t[1],c=function(e){return n===e&&"active"};return Object(a.jsxs)(j.a,{className:"w-75",children:[Object(a.jsxs)(ye.a,{onClick:function(e){return o(e.target.id)},className:"btn-group btn-header",children:[Object(a.jsx)(de.a,{id:"document",className:c("document"),children:"Document"}),Object(a.jsx)(de.a,{id:"training",className:c("training"),children:"Online training"})]}),"document"===n&&Object(a.jsx)(Je,{}),"training"===n&&Object(a.jsx)(Xe,{})]})},Ze=function(e,t,n,r){var o=r.setFormData;return Object(a.jsx)(de.a,{variant:"outline-primary",onClick:function(){return o(t)},size:"sm",children:"Edit"})},Ke=function(e,t,n,r){var o=r.setRow,c=r.setShowModal;return Object(a.jsx)(de.a,{id:"save",size:"sm",onClick:function(){o(t),c(!0)},children:"Send"})},Ye=function(e){var t=e.setRecords,n=e.formData,r=e.setFormData,o=e.actual,c=R(n),i={setRecords:t,formData:n,setFormData:r,actual:o};return Object(a.jsxs)(he.a,{show:!0,onHide:function(){return r(void 0)},centered:!0,size:"lg",children:[Object(a.jsx)(he.a.Header,{closeButton:!0,children:Object(a.jsxs)(he.a.Title,{children:["Edit ",c]})}),Object(a.jsx)(he.a.Body,{children:"document"===c?Object(a.jsx)(Je,Object(l.a)({},i)):Object(a.jsx)(Xe,Object(l.a)({},i))})]})},Qe=function(){var e=Oe("/document/edited"),t=Object(i.a)(e,3),n=t[0],o=t[1],c=t[2],s=Oe("/training/edited"),d=Object(i.a)(s,3),u=d[0],j=d[1],b=d[2],m=Object(r.useState)([]),f=Object(i.a)(m,2),h=f[0],p=f[1],x=Object(r.useState)([]),g=Object(i.a)(x,2),v=g[0],y=g[1],k=Object(r.useState)(),E=Object(i.a)(k,2),C=E[0],T=E[1],_=Object(r.useState)(),D=Object(i.a)(_,2),P=D[0],M=D[1],L=Object(r.useState)(!1),A=Object(i.a)(L,2),I=A[0],B=A[1],G=Object(r.useState)(),J=Object(i.a)(G,2),V=J[0],X=J[1];Object(r.useEffect)((function(){n&&u&&(p(n),y(u))}),[n,u]);var W=function(){"document"===R(V)?p((function(e){return e.filter((function(e){return e.id!==V.id}))})):y((function(e){return e.filter((function(e){return e.id!==V.id}))}))};if(c)return Object(a.jsx)(fe,{e:"Error: ".concat(c.message)});if(b)return Object(a.jsx)(fe,{e:"Error: ".concat(b.message)});if(!o||!n||!j||!u)return Object(a.jsx)(me,{});var Z=function(e,t,n){return[{dataField:"name",text:"Name",sort:!0},{dataField:"date.Time",text:"Release",sort:!0,formatter:S},{dataField:"place",text:"Place",sort:!0},Object(l.a)(Object(l.a)({},N("EditBtn")),{},{formatter:Ze,formatExtraData:{setFormData:e}}),Object(l.a)(Object(l.a)({},N("SendBtn")),{},{formatter:Ke,formatExtraData:{setRow:t,setShowModal:n}})]}(M,X,B),K=function(e,t,n){return[{dataField:"name",text:"Name",sort:!0},{dataField:"release_date.Time",text:"Release",sort:!0,formatter:F},{dataField:"deadline.Time",text:"Deadline",sort:!0,formatter:w},Object(l.a)(Object(l.a)({},N("EditBtn")),{},{formatter:Ze,formatExtraData:{setFormData:e}}),Object(l.a)(Object(l.a)({},N("SendBtn")),{},{formatter:Ke,formatExtraData:{setRow:t,setShowModal:n}})]}(M,X,B);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(le,{title:"Saved documents",data:h,columns:K,order:z("deadline.Time")}),Object(a.jsx)(le,{title:"Saved trainings",data:v,columns:Z,order:z("deadline.Time")}),C&&Object(a.jsx)(we,{notification:C}),P&&Object(a.jsx)(Ye,{setRecords:"document"===R(P)?p:y,formData:P,setFormData:M}),I&&Object(a.jsx)(pe,{handleAccept:function(){fetch(O+"/".concat(R(V),"/confirm/").concat(V.id),{method:"GET"}).then((function(e){U(e)?(W(),T(q("Record ".concat(V.name," was successfully sent")))):T(H("Record ".concat(V.name," failed")))})).catch((function(e){return console.log(e)}))},showModal:I,setShowModal:B,modalInfo:{body:"Do you really want to send the record to the employees?"}})]})},$e=function(){var e=Object(r.useState)(),t=Object(i.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)(null),s=Object(i.a)(c,2),l=s[0],d=s[1],u=Object(r.useState)({}),j=Object(i.a)(u,2),b=j[0],m=j[1],f=Object(r.useState)(),h=Object(i.a)(f,2),p=h[0],x=h[1],g=Object(r.useState)(),v=Object(i.a)(g,2),y=v[0],S=v[1],w=function(){x(void 0),S(void 0)};return Object(a.jsxs)("div",{children:[Object(a.jsx)("script",{crossOrigin:"true"}),Object(a.jsx)("p",{className:"pt-5",children:Object(a.jsx)("strong",{children:"IMPORT EMPLOYEES"})}),Object(a.jsxs)(ve.a,{children:[Object(a.jsx)("select",{onChange:function(e){return o(e.target.value)},name:"type",required:!0,value:n,children:J(["import_1","import_2","import_3","import_4","import_5"])}),Object(a.jsx)("span",{children:" Choose import"}),Object(a.jsx)("br",{}),Object(a.jsx)("input",{type:"file",required:!0,onChange:function(e){return m(e.target.files[0])}}),Object(a.jsx)(de.a,{type:"button",onClick:function(){w();var e=new FormData,t="employees_upload_".concat(Date.now());n?(e.append("file",b),e.append("name",t),e.append("import",n),b?fetch(O+"/file/upload",{method:"POST",body:e}).then((function(e){U(e)?S(q("Successfully uploaded.")):S(H("Import was unsuccessful"))})).catch((function(e){return S(H("Error submitting form! "+e))})):S(H("File is not set"))):S(H("Select type"))},children:"Upload"}),y&&Object(a.jsx)(we,{notification:y})]}),Object(a.jsx)("hr",{}),Object(a.jsx)("p",{className:"pt-5",children:Object(a.jsx)("strong",{children:"IMPORT CARDS"})}),Object(a.jsxs)(ve.a,{children:[Object(a.jsx)("p",{style:{marginBottom:"4px"},children:"Upload file with employee card information"}),Object(a.jsx)("input",{type:"file",id:"cardsFile",onChange:function(e){return d(e.target.files[0])}}),Object(a.jsx)(de.a,{type:"button",onClick:function(e){w();var t=new FormData,n="kiosk_upload_".concat(Date.now());t.append("file",l),t.append("name",n),console.log(l),l?fetch(O+"/file/upload",{method:"POST",body:t}).then((function(e){console.log(e),U(e)?x(q("Successfully uploaded.")):x(H("Import was unsuccessful"))})).catch((function(e){return x(H("Error submitting form! "+e))})):x(H("File is not set"))},children:"Upload"}),p&&Object(a.jsx)(we,{notification:p})]}),Object(a.jsx)("hr",{})]})},et={width:"20%",marginLeft:"4px"},tt=function(e){var t=e.showSM,n=e.setShowSM,o=e.matrixByCombination,c=e.matrixBySuperior,s=e.searchByCombination,d=e.searchByPerson,u=Object(r.useContext)(wt),j=Object(r.useState)([]),b=Object(i.a)(j,2),m=b[0],f=b[1],O=Object(r.useState)([]),h=Object(i.a)(O,2),p=h[0],x=h[1],g=X(u),v=Object(r.useState)({branches:[],cities:[],departments:[],divisions:[]}),y=Object(i.a)(v,2),S=y[0],w=y[1],F=Object(r.useState)({employee:"",lector:""}),k=Object(i.a)(F,2),E=k[0],C=k[1],T=Object(r.useState)(""),_=Object(i.a)(T,2),D=_[0],N=_[1];Object(r.useEffect)((function(){oe("/employees/all").then((function(e){var t,n;console.log("employees",e),f((t=e,n=u.departments,(t=ne(t)).map((function(e){return{value:e.id,label:ae(e,n)}}))))})),oe("/lectors/all").then((function(e){return x(e.map((function(e){return{value:e,label:e}})))}))}),[]);var R=function(){var e;(N("structure"),t)?o({branch:"",city:S.cities.map((function(e){return e.value})).join(","),department:S.departments.map((function(e){return e.value})).join(","),division:""}):s({branch:(e=S).branches.map((function(e){return e.value})).join(","),city:e.cities.map((function(e){return e.value})).join(","),department:e.departments.map((function(e){return e.value})).join(","),division:e.divisions.map((function(e){return e.value})).join(",")})},P=function(){N("person"),t?c(E):d(E)},M=function(e){return Object(a.jsx)("div",{style:et,children:Object(a.jsx)(Ie.a,{isClearable:!0,isMulti:!0,value:S[e],name:e,placeholder:"Select ".concat(e),options:g[e],onChange:function(e,t){return function(e,t){var n=t.name;return w(Object(l.a)(Object(l.a)({},S),{},Object(Ae.a)({},n,e)))}(e,t)}})})},L=function(e,t,n,r){return Object(a.jsx)("div",{style:et,children:Object(a.jsx)(Ie.a,{isClearable:!0,value:r,name:e,placeholder:t,options:n,onChange:function(e,t){return function(e,t){var n=t.name;return C(Object(l.a)(Object(l.a)({},E),{},Object(Ae.a)({},n,e)))}(e,t)}})})};return Object(a.jsxs)(ve.a,{children:[Object(a.jsxs)(Ne.a,{className:"pb-2",children:[Object(a.jsx)(de.a,{style:{backgroundColor:"structure"===D?"#f3c404f2 ":"#343a40",border:"none"},onClick:R,children:"Search structure"}),M("branches"),M("divisions"),M("departments"),M("cities"),Object(a.jsx)(Re.a,{className:"text-right pr-0",children:Object(a.jsx)(de.a,{className:"mr-3",variant:"outline-primary",onClick:function(){var e=!t;n(e),e?"structure"===D?(console.log("searchStructure"),o({branch:"",city:S.cities.map((function(e){return e.value})).join(","),department:S.departments.map((function(e){return e.value})).join(","),division:""})):c(E.employee):"structure"===D?R():P()},children:"".concat(t?"Table":"Matrix")})})]}),Object(a.jsxs)(Ne.a,{children:[Object(a.jsx)(de.a,{style:{backgroundColor:"person"===D?"#f3c404f2 ":"#343a40",border:"none",paddingRight:"26px"},onClick:P,children:"Search person"}),L("employee","Select employee",m,E.employee),L("lector","Select lector",p,E.lector)]})]})},nt=function(e,t,n,r){r.id;var o,c=r.data,i=r.setData,s=r.i,d=c[n],u=(null===(o=d.employees[s])||void 0===o?void 0:o.state)||"_",j=u.includes("X");function m(){return u.includes("X")?1===u.length&&"X"!==u?u:u.substr(1):u}j&&(u=m());var f={backgroundColor:function(e){switch(e){case"-":return"gray";case"_":return"cornflowerblue";case"es":return"tomato";case"e":return"orange";case"s":return"gold";default:return"green"}}(u),color:"s"===u?"black":"white",borderColor:j?"black":"white",borderWidth:"5px"};return Object(a.jsx)(de.a,{style:f,onClick:function(){var e=j?m():"X"+u,t=Object(b.a)(d.employees);t[s]=Object(l.a)(Object(l.a)({},t[s]),{},{state:e});var a=Object(b.a)(c);a[n]=Object(l.a)(Object(l.a)({},d),{},{employees:t}),i(a)},className:"btn-block",children:function(){var e;return null===(e=[{state:"-",label:"no need"},{state:"es",label:"miss e+s"},{state:"e",label:"miss e"},{state:"s",label:"miss s"},{state:"",label:"well done"},{state:"X",label:"bug"},{state:"_",label:"not send"}].find((function(e){return e.state===u})))||void 0===e?void 0:e.label}()})},at=n(250),rt=function(e){var t=e.data,n=e.setAction,r=e.setModalInfo,o=e.setShowModal,c=e.handleAccept,i=e.showLegend,s=e.setShowLegend,l=function(e){var t=e.target.id;n(t),"cancel"===t?c():(r({body:"Do you really want to ".concat(t," selected signatures?")}),o(!0))},d=0===t.length;return Object(a.jsxs)(Ne.a,{className:"mb-3",children:[Object(a.jsx)(Re.a,{className:"text-left",children:Object(a.jsx)(ye.a,{className:"div-btn",size:"sm",children:Object(a.jsx)(de.a,{onClick:function(){return s(!i)},children:i?"Hide legend":"Show legend"})})}),Object(a.jsx)(Re.a,{className:"text-right",children:Object(a.jsxs)(ye.a,{className:"div-btn",onClick:l,size:"sm",children:[Object(a.jsx)(de.a,{id:"sign",size:"sm",disabled:d,children:"Sign"}),Object(a.jsx)(de.a,{id:"cancelDuty",size:"sm",disabled:d,children:"Cancel duty"}),Object(a.jsx)(de.a,{id:"trainAgain",size:"sm",disabled:d,children:"Train again"}),Object(a.jsx)(de.a,{id:"cancel",size:"sm",onClick:l,disabled:d,children:"Cancel"})]})})]})},ot=function(){var e=function(e){var t=e.color,n=e.textColor,r=void 0===n?"white":n,o=e.label,c=e.text,i={background:t,borderColor:t,color:r,width:"80px",height:"20px",fontSize:".7rem",fontWeight:"bold",padding:"0"};return Object(a.jsx)("p",{children:Object(a.jsxs)("span",{children:[Object(a.jsx)(de.a,{style:i,children:o})," ".concat(c)]})})};return Object(a.jsx)(at.a,{style:{width:"30rem",marginTop:"1rem",fontSize:".7rem",marginBottom:".75rem"},children:Object(a.jsxs)(at.a.Body,{children:[Object(a.jsx)(at.a.Subtitle,{className:"mb-3 text-muted",children:"Legend:"}),Object(a.jsxs)(at.a.Text,{children:[Object(a.jsx)(e,{label:"no need",text:"Zamestnanec bol odzna\u010den\xfd z potreby obozn\xe1menia",color:"gray"}),Object(a.jsx)(e,{label:"miss e+s",text:"Ani zamestnanec ani nadriaden\xfd e\u0161te nepotvrdili",color:"tomato"}),Object(a.jsx)(e,{label:"miss e",text:"Zamestnanec nepotvrdil",color:"orange"}),Object(a.jsx)(e,{label:"miss s",text:"Nadriaden\xfd nepotvrdil",color:"gold",textColor:"white"}),Object(a.jsx)(e,{label:"well done",text:"Dokument je potvrden\xfd",color:"green"}),Object(a.jsx)(e,{label:"not sent",text:"Este neodoslane",color:"cornflowerblue"}),Object(a.jsxs)("p",{children:[Object(a.jsx)(g.a,{style:{color:"red",marginBottom:"4px"}})," ","Uplynul deadline a ch\xfdbaj\xfa podpisy"]}),Object(a.jsxs)("p",{children:["hviezdi\u010dka ",Object(a.jsx)("strong",{children:"*"})," znamena, ze zamestnanec sa opakovane pre\u0161koluje"]})]})]})})},ct=function(e){var t=e.SMData,n=Object(r.useState)([]),o=Object(i.a)(n,2),c=o[0],s=o[1],d=Object(r.useState)([]),u=Object(i.a)(d,2),j=u[0],b=u[1];Object(r.useEffect)((function(){if(console.log("SMData",t),t.documents){var e,n=t.documents[0];if(n&&n.signatures)b(ne(t.employees)),s((e=t.documents,console.log("prepareSMData",e),e.map((function(e){var t=Z(e.signatures);return{id:e.id,name:e.name,require_superior:e.require_superior,deadline:e.deadline.Time,employees:t.map((function(t){return{id:t.employee.id,sign_id:t.id,state:W(t,e.require_superior)}}))}}))));else s([])}}),[t,t.documents]);var m=Object(r.useState)(!1),f=Object(i.a)(m,2),h=f[0],p=f[1],x=Object(r.useState)(!1),g=Object(i.a)(x,2),v=g[0],y=g[1],S=Object(r.useState)({}),w=Object(i.a)(S,2),F=w[0],k=w[1],E=Object(r.useState)(""),C=Object(i.a)(E,2),T=C[0],_=C[1],R=function(){var e=[{dataField:"name",text:"Document Name",formatter:D,headerStyle:{width:"1%"},sort:!0}],t=0;return console.log(c),j.forEach((function(n){var a="".concat(n.first_name," ").concat(n.last_name,", ").concat(n.job_title);e.push(Object(l.a)(Object(l.a)({},N(n.id,a)),{},{formatter:nt,formatExtraData:{id:n.id,data:c,setData:s,i:t++%j.length}}))})),e}();function P(e){return"s"===e?"":"e"}var M=function(){var e=c.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{employees:e.employees.map((function(t){return function(e,t){if(!function(e){return e.state.includes("X")}(t))return t;var n=t.state.replace("X","");return"sign"===T?"-"===n||"e"===n||""===n?Object(l.a)(Object(l.a)({},t),{},{state:n}):(fetch(O+"/sign/superior",{method:"POST",body:new URLSearchParams("id=".concat(t.sign_id))}),Object(l.a)(Object(l.a)({},t),{},{state:P(n)})):"cancelDuty"===T?"-"===n?Object(l.a)(Object(l.a)({},t),{},{state:n}):(fetch(O+"/cancels",{method:"POST",body:new URLSearchParams(t.sign_id.toString())}),Object(l.a)(Object(l.a)({},t),{},{state:"-"})):"trainAgain"===T?e&&"e+s"===n?Object(l.a)(Object(l.a)({},t),{},{state:n}):e||"e"!==n?(fetch(O+"/resigns",{method:"POST",body:new URLSearchParams(t.sign_id.toString())}),n=function(e){return e?"es":"s"}(t.sign_id),Object(l.a)(Object(l.a)({},t),{},{state:n})):Object(l.a)(Object(l.a)({},t),{},{state:n}):void 0}(e.require_superior,t)}))})}));s(e)};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(le,{title:"SkillMatrix",classes:"skill-matrix-table",data:c,columns:R,wrapperClasses:"table-responsive",rowClasses:"text-nowrap"}),Object(a.jsx)(rt,{data:c,setAction:_,setModalInfo:k,setShowModal:y,handleAccept:M,handleExport:function(){},showLegend:h,setShowLegend:p}),h&&Object(a.jsx)(ot,{}),Object(a.jsx)(pe,{showModal:v,setShowModal:y,modalInfo:F,handleAccept:M})]})},it=function(e,t){return Object(a.jsx)(de.a,{href:"/".concat(R(t),"/report/").concat(t.id),type:"link",size:"sm",children:"Report"})},st=function(e){var t=e.found,n=e.setFound,o=Object(r.useState)(),c=Object(i.a)(o,2),s=c[0],d=c[1],u=Object(r.useState)(),j=Object(i.a)(u,2),b=(j[0],j[1]),m=[{dataField:"name",text:"Name",sort:!0},{dataField:"release_date.Time",text:"Release",formatter:F,sort:!0},{dataField:"type",text:"Type",sort:!0},{dataField:"branches",text:"Branches",sort:!0},{dataField:"divisions",text:"Divisions",sort:!0},{dataField:"departments",text:"Departments",sort:!0},{dataField:"cities",text:"Cities",sort:!0},{dataField:"complete",text:"State",formatter:T,sort:!0},Object(l.a)(Object(l.a)({},N("EditBtn")),{},{formatter:Ze,formatExtraData:{setFormData:d}}),Object(l.a)(Object(l.a)({},N("ReportBtn")),{},{formatter:it,formatExtraData:{setReport:b}})];return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(le,{title:"Found documents",data:t,columns:m,defaultSorted:z("name"),wrapperClasses:"table-responsive",rowClasses:"text-nowrap"}),s&&Object(a.jsx)(Ye,{setRecords:n,formData:s,setFormData:d,actual:!0})]})},lt=function(e){var t=e.found,n=e.setFound,o=Object(r.useState)(),c=Object(i.a)(o,2),s=c[0],d=c[1],j=Object(r.useState)(),b=Object(i.a)(j,2),m=b[0],f=b[1],O=[{dataField:"name",text:"Name",sort:!0},{dataField:"date.Time",text:"Release",formatter:S,sort:!0},{dataField:"lector",text:"Lector",sort:!0},{dataField:"agency",text:"Agency",sort:!0},{dataField:"place",text:"Place",sort:!0},{dataField:"complete",text:"State",formatter:T,sort:!0},Object(l.a)(Object(l.a)({},N("EditBtn")),{},{formatter:Ze,formatExtraData:{setFormData:d}}),Object(l.a)(Object(l.a)({},N("ReportBtn")),{},{formatter:it,formatExtraData:{setReport:f}})];return m?Object(a.jsx)(u.a,{to:{pathname:"/training/report",search:""+m.id}}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(le,{title:"Found trainings",data:t,columns:O,defaultSorted:z("name"),wrapperClasses:"table-responsive",rowClasses:"text-nowrap"}),s&&Object(a.jsx)(Ye,{setRecords:n,formData:s,setFormData:d,actual:!0})]})},dt=function(e){var t=e.documents,n=e.setDocuments,r=e.trainings,o=e.setTrainings;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(st,{found:t,setFound:n}),Object(a.jsx)(lt,{found:r,setFound:o})]})},ut=function(){var e=Object(r.useContext)(wt),t=Object(r.useState)([]),n=Object(i.a)(t,2),o=n[0],c=n[1],s=Object(r.useState)([]),l=Object(i.a)(s,2),d=l[0],u=l[1],j=Object(r.useState)([]),b=Object(i.a)(j,2),m=b[0],f=b[1],h=Object(r.useState)([]),p=Object(i.a)(h,2),x=p[0],g=p[1],v=Object(r.useState)(),y=Object(i.a)(v,2),S=y[0],w=y[1];Object(r.useEffect)((function(){oe("/combinations").then((function(e){return c(V(e))}))}),[]),Object(r.useEffect)((function(){oe("/document/actual").then((function(t){u(re(t,e)),console.log("document",t)})),oe("/training/all").then((function(e){console.log("training",e),f(e)}))}),[o]);var F=function(){u([]),f([])};return o.length?Object(a.jsxs)("div",{style:{marginTop:"1%"},className:"finder",children:[Object(a.jsx)(tt,{showSM:S,setShowSM:w,matrixByCombination:function(e){fetch(O+"/skill/matrix",{method:"POST",body:new URLSearchParams("filter=".concat(JSON.stringify(e)))}).then((function(e){return e.json()})).then((function(e){console.log("/skill/matrix by combination",e),g(e)}))},matrixBySuperior:function(e){fetch(O+"/skill/matrix",{method:"POST",body:new URLSearchParams("superior_id=".concat(e.value))}).then((function(e){return e.json()})).then((function(e){console.log("/skill/matrix by superior",e),g(e)}))},searchByCombination:function(t){F(),ce("/document/filter",JSON.stringify(t)).then((function(t){return u(re(t,e))}))},searchByPerson:function(e){if(e.employee||e.lector){var t=e.employee.value;console.log("person",e),ce("/training/filter","".concat(JSON.stringify({employee:t,lector:e.lector.value}))).then((function(e){return console.log("training by filter",e)})),F(),oe("/document/manager/".concat(t)).then((function(e){console.log("/document/manager/",e),u(e)}))}}}),S?Object(a.jsx)(ct,{SMData:x}):Object(a.jsx)(dt,{documents:d,setDocuments:u,trainings:m,setTrainings:f})]}):Object(a.jsx)(me,{})},jt=function(e){var t=e.match,n=Object(r.useState)([]),o=Object(i.a)(n,2),c=o[0],s=o[1],l=Object(r.useState)([]),d=Object(i.a)(l,2),u=d[0],j=d[1],m=Object(r.useState)(!1),f=Object(i.a)(m,2),O=f[0],h=f[1];Object(r.useEffect)((function(){var e=t.params.id;oe("/document/report/".concat(e)).then((function(t){console.log("res",t),console.log("id",e),1===t.length&&t[0].id==e?(console.log("hello"),p(t[0])):s(t)}))}),[]);var p=function(e){h(e.require_superior),j(e.signatures.map((function(e){var t=e.employee;return{id:e.employee_id,name:"".concat(t.first_name," ").concat(t.last_name),e_date:y(e.e_date),s_date:y(e.s_date)}})))},x=[{dataField:"name",text:"Full name",sort:!0},{dataField:"e_date",text:"Sign Date",sort:!0}];O&&(x=[].concat(Object(b.a)(x),[{dataField:"s_date",text:"Superior",sort:!0}]));var g=function(e){var t=e.rep;return Object(a.jsx)("p",{children:Object(a.jsx)("a",{href:"/document/report/".concat(t.id),children:"".concat(t.name,", version: ").concat(t.version,", date: ").concat(y(t.release_date))})})};return Object(a.jsxs)("div",{children:[c.map((function(e){return Object(a.jsx)(g,{rep:e})})),Object(a.jsx)(le,{title:"Prezencna listina",data:u,columns:x,defaultSorted:z("name"),wrapperClasses:"table-responsive",rowClasses:"text-nowrap"})]})},bt=function(){var e=Object(u.g)().pathname;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{className:"pt-5",children:"Error 404: Page not found"}),Object(a.jsxs)("h5",{className:"pt-3",children:["Not match for ",Object(a.jsx)("code",{children:e})]})]})},mt=function(e){var t=e.match,n=Object(r.useState)([]),o=Object(i.a)(n,2),c=o[0],s=o[1],l=Object(r.useState)([]),d=Object(i.a)(l,2),u=d[0],j=d[1];Object(r.useEffect)((function(){var e=t.params.id;oe("/training/report/".concat(e)).then((function(e){console.log("res",e),s([{label:"N\xe1zov \u0161kolenia:",value:e.name},{label:"D\xe1tum a miesto konania \u0161kolenia:",value:y(e.date)+" "+e.place},{label:"N\xe1zov vzdel\xe1vacej agent\xfary:",value:e.agency},{label:"Meno a priezvisko \u0161kolite\u013ea:",value:e.lector},{label:"Podpis \u0161kolite\u013ea:",value:"?"}]),j(e.signatures.map((function(e){var t=e.employee;return{id:t.id,name:"".concat(t.first_name," ").concat(t.last_name),date:y(e.date)}})))}))}),[]);return Object(a.jsxs)("div",{children:[Object(a.jsx)(le,{title:"Prezencna listina",data:c,columns:[{dataField:"label",text:""},{dataField:"value",text:""}],defaultSorted:z("name"),headerClasses:"d-none",classes:"report"}),Object(a.jsx)("br",{}),Object(a.jsx)(le,{data:u,columns:[{dataField:"name",text:"Full name",sort:!0},{dataField:"department",text:"Department",sort:!0},{dataField:"date",text:"Sign Date",sort:!0}],defaultSorted:z("name"),wrapperClasses:"table-responsive",rowClasses:"text-nowrap"})]})},ft=function(){var e=A(),t=B(),n=function(t){var n=t.component,r=Object(d.a)(t,["component"]);return e?Object(a.jsx)(u.b,Object(l.a)(Object(l.a)({},r),{},{component:n})):Object(a.jsx)(u.a,{to:"/login"})};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(j.a,{children:Object(a.jsxs)(u.d,{children:[Object(a.jsx)(u.b,{exact:!0,path:"/",render:function(){return A()?Object(a.jsx)(u.a,{to:"/records-to-sign",component:xe}):Object(a.jsx)(u.a,{to:"/login",component:Te})}}),Object(a.jsx)(u.b,{path:"/login",component:Te}),Object(a.jsx)(u.b,{path:"/logout",component:_e}),Object(a.jsx)(n,{path:"/records-to-sign",component:xe}),Object(a.jsx)(n,{path:"/signed-records",component:De}),t&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(n,{path:"/add-record",component:We}),Object(a.jsx)(n,{path:"/saved-record",component:Qe}),Object(a.jsx)(n,{path:"/settings",component:$e}),Object(a.jsx)(n,{path:"/document/report/:id",component:jt}),Object(a.jsx)(n,{path:"/training/report/:id",component:mt})]}),Object(a.jsx)(u.b,{path:"*",component:bt})]})}),Object(a.jsx)("div",{className:"large-container",children:t&&Object(a.jsx)(n,{path:"/finder",component:ut})})]})},Ot=n(128),ht=n(248),pt=n(249),xt=n.p+"static/media/logo.923adaad.png",gt=function(){var e=A(),t=B(),n="sk"===JSON.parse(sessionStorage.getItem("language"))?Fe.sk:Fe.en;n=n.navigation;var r=function(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Ot.a,{href:"/records-to-sign",children:n.recordsToSign}),Object(a.jsx)(Ot.a,{href:"/signed-records",children:n.signedRecords}),t&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Ot.a,{href:"/add-record",children:n.addRecord}),Object(a.jsx)(Ot.a,{href:"/saved-record",children:n.savedRecords}),Object(a.jsx)(Ot.a,{href:"/finder",children:n.finder}),Object(a.jsx)(Ot.a,{href:"/settings",children:n.settings})]}),Object(a.jsx)(Ot.a,{href:"/logout",children:n.logout})]})},o=function(){return Object(a.jsx)(Ot.a,{href:"/login",children:n.login})},c=function(){var t=e?"".concat(e.first_name," ").concat(e.last_name):"";return Object(a.jsx)("span",{style:{color:"white"},children:t})};return Object(a.jsxs)(ht.a,{expand:"md",bg:"dark",variant:"dark",sticky:"top",className:"navigation",children:[Object(a.jsx)(ht.a.Brand,{href:"/",children:Object(a.jsx)("img",{alt:"logo",src:xt,width:"50",height:"50",className:"d-inline-block align-top"})}),Object(a.jsx)(c,{}),Object(a.jsx)(ht.a.Toggle,{}),Object(a.jsx)(ht.a.Collapse,{id:"responsive-navbar-nav",children:Object(a.jsx)(pt.a,{className:"ml-auto",variant:"pills",activeKey:Object(u.g)().pathname,children:e?Object(a.jsx)(r,{}):Object(a.jsx)(o,{})})})]})},vt=n(33),yt=n(34),St=function(){function e(t){var n=t.timeout,a=t.onTimeout;Object(vt.a)(this,e),this.timeout=n,this.onTimeout=a,this.eventHandler=this.updateExpiredTime.bind(this),this.tracker(),this.startInterval()}return Object(yt.a)(e,[{key:"startInterval",value:function(){var e=this;this.updateExpiredTime(),this.interval=setInterval((function(){parseInt(localStorage.getItem("_expiredTime"),10)<Date.now()&&e.onTimeout&&(e.onTimeout(),e.cleanUp())}),1e3)}},{key:"updateExpiredTime",value:function(){var e=this;this.timeoutTracker&&clearTimeout(this.timeoutTracker),this.timeoutTracker=setTimeout((function(){localStorage.setItem("_expiredTime",Date.now()+1e3*e.timeout)}),300)}},{key:"tracker",value:function(){window.addEventListener("mousemove",this.eventHandler),window.addEventListener("scroll",this.eventHandler),window.addEventListener("keydown",this.eventHandler)}},{key:"cleanUp",value:function(){localStorage.removeItem("_expiredTime"),clearInterval(this.interval),window.removeEventListener("mousemove",this.eventHandler),window.removeEventListener("scroll",this.eventHandler),window.removeEventListener("keydown",this.eventHandler)}}]),e}(),wt=Object(r.createContext)(void 0);var Ft=function(){var e=Object(r.useState)({branches:[],divisions:[],cities:[],departments:[]}),t=Object(i.a)(e,2),n=t[0],o=t[1];return Object(r.useEffect)((function(){var e={};h.forEach((function(t){oe("/".concat(t)).then((function(n){return e[t]=n}))})),o(e)}),[]),Object(r.useEffect)((function(){var e=new St({timeout:600,onTimeout:function(){var e;A()&&(I(),e="/login",window.location.replace(e))}});return function(){return e.cleanUp()}}),[]),Object(a.jsxs)(s.a,{children:[Object(a.jsx)(gt,{}),Object(a.jsx)(wt.Provider,{value:n,children:Object(a.jsx)(ft,{})})]})};n(231),n(232);c.a.render(Object(a.jsx)(Ft,{}),document.getElementById("root"))}},[[233,1,2]]]);
//# sourceMappingURL=main.4864c5ff.chunk.js.map